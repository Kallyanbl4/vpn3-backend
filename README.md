# VPN3 Backend

![vpn3-backend](https://img.shields.io/badge/status-active-brightgreen)

Backend-—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VPN-—Å–∏—Å—Ç–µ–º–æ–π, –≤–∫–ª—é—á–∞—è —Ç–∞—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é, –ø–ª–∞—Ç–µ–∂–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å VPN-—Å–µ—Ä–≤–µ—Ä–æ–º –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Telegram-–±–æ—Ç–æ–º.

## üìå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**:
  - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT, bcrypt)
  - –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–∞ (User, Admin, SuperAdmin)
  - –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- **–¢–∞—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–¥–ø–∏—Å–∫–∏**:
  - –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–Ω—ã–º–∏ –ø–ª–∞–Ω–∞–º–∏
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –æ–ø–ª–∞—Ç—ã (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –µ–∂–µ–º–µ—Å—è—á–Ω–æ, –µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ, –µ–∂–µ–≥–æ–¥–Ω–æ)
  - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
  - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã
  - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤ –∏ —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏

- **–ü–ª–∞—Ç–µ–∂–∏**:
  - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –∏–Ω—Ç–µ–Ω—Ç–æ–≤
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
  - –í–æ–∑–≤—Ä–∞—Ç—ã –∏ —á–∞—Å—Ç–∏—á–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã
  - –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –∏ –æ—Ç—á–µ—Ç—ã

- **–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GraphQL API —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Prisma ORM (PostgreSQL)
  - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å Redis (CacheModule)
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram (–±–æ—Ç –¥–ª—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `class-validator`
  - –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`ConfigModule`)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```sh
$ git clone https://github.com/Kallyanbl4/vpn3-backend.git
$ cd vpn3-backend
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```sh
$ bun install
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example` –∏ —É–∫–∞–∂–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
DATABASE_URL=postgres://user:password@localhost:5432/vpn3
JWT_SECRET=your_jwt_secret
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
```

### 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma-–∫–ª–∏–µ–Ω—Ç–∞

```sh
$ bunx prisma migrate dev
$ bunx prisma generate
```

### 5. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

#### –í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```sh
$ bun run start:dev
```

#### –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Ä–µ–∂–∏–º–µ:
```sh
$ bun run build && bun run start:prod
```

### 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```sh
$ bun test
```

## üî• API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### GraphQL API
- GraphQL Playground –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3000/graphql`
- –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –º—É—Ç–∞—Ü–∏–∏:

  #### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:
  - `register` ‚Äì —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `login` ‚Äì –≤—Ö–æ–¥, –≤—ã–¥–∞—á–∞ JWT-—Ç–æ–∫–µ–Ω–∞
  - `logout` ‚Äì –≤—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

  #### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
  - `me` ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
  - `user(id)` ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ ID (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å Admin)
  - `users` ‚Äì —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å Admin)
  - `updateUser` ‚Äì –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
  - `deleteUser` ‚Äì —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å Admin)

  #### –¢–∞—Ä–∏—Ñ—ã:
  - `tariffPlans` ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤
  - `activeTariffPlans` ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤
  - `tariffPlan(id)` ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ
  - `compareTariffs(ids)` ‚Äì —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤
  - `calculateTariffPrice(id, duration)` ‚Äì —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–∞—Ä–∏—Ñ–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
  - `createTariffPlan` ‚Äì —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∞—Ä–∏—Ñ–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å Admin)
  - `updateTariffPlan` ‚Äì –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–∞—Ä–∏—Ñ–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å Admin)
  - `changeTariffStatus` ‚Äì –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ç–∞—Ä–∏—Ñ–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å Admin)
  - `createTemporaryTariff` ‚Äì —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å Admin)

  #### –ü–ª–∞—Ç–µ–∂–∏:
  - `userPayments` ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `payment(id)` ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø–ª–∞—Ç–µ–∂–µ
  - `paymentIntent(id)` ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞—Ç–µ–∂–Ω–æ–º –∏–Ω—Ç–µ–Ω—Ç–µ
  - `createPaymentIntent` ‚Äì —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –∏–Ω—Ç–µ–Ω—Ç–∞
  - `processPayment` ‚Äì –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞
  - `refundPayment` ‚Äì –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤

## üì¶ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ NestJS:

- `/auth` ‚Äì –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `/user` ‚Äì —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `/tariff` ‚Äì —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–Ω—ã–º–∏ –ø–ª–∞–Ω–∞–º–∏
- `/payment` ‚Äì —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞–º–∏ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
- `/config` ‚Äì –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `/common` ‚Äì –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–∫—ç—à, —Ñ–∏–ª—å—Ç—Ä—ã, –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã)
- `/prisma` ‚Äì –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **NestJS** ‚Äì —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Prisma** ‚Äì ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **PostgreSQL** ‚Äì —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **GraphQL** ‚Äì –æ—Å–Ω–æ–≤–Ω–æ–µ API
- **Redis** ‚Äì –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **JWT** ‚Äì –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Bun** ‚Äì JavaScript/TypeScript runtime –∏ –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
- **Telegraf** ‚Äì Telegram-–±–æ—Ç

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è
MIT

## üë• –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —Å–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å–æ –º–Ω–æ–π:
- Telegram: [@your_username](https://t.me/your_username)
- Email: your@email.com